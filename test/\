# coding=utf-8
import socket  # socket模块
import commands  # 执行系统命令模块
HOST = '127.0.0.1'
PORT = 1234
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)  # 定义socket类型，网络通信，TCP
s.bind((HOST, PORT))  # 套接字绑定的IP与端口
s.listen(1)  # 开始TCP监听
count = 0
while 1:
	conn, addr = s.accept()  # 接受TCP连接，并返回新的套接字与IP地址
        print'Connected by', addr  # 输出客户端的IP地址
        while 1:
		data = conn.recv(100)  # 把接收的数据实例化
		if count == 0:
			if data[:8] != "ustar123":
				conn.send('登入失败')
			else:
				conn.send('登入成功')
				count = 1
		if count == 1:
			print(data)
			conn.sendall(data)
conn.close()  # 关闭连接
